<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{LvsAreas/LvsUsers/LvsLayout/LvsUser-layout}">

<head>
    <title>Report Detail - WeJect</title>
</head>

<body>
    <div layout:fragment="content">
        <div class="container mx-auto px-4 py-8">
            <!-- Header -->
            <div class="flex items-center justify-between mb-8">
                <div>
                    <h1 class="text-3xl font-bold text-white mb-2">
                        <i class="fas fa-file-alt text-purple-400 mr-3"></i>Report Detail
                    </h1>
                    <p class="text-gray-400">Review and resolve this report</p>
                </div>
                <a th:href="@{/LvsModeration/LvsReports}"
                    class="px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-semibold transition-all">
                    <i class="fas fa-arrow-left mr-2"></i>Back to Reports
                </a>
            </div>

            <!-- Success/Error Messages -->
            <div th:if="${successMessage}" class="mb-6 p-4 bg-green-500/20 border border-green-500/50 rounded-lg">
                <p class="text-green-400"><i class="fas fa-check-circle mr-2"></i><span
                        th:text="${successMessage}"></span></p>
            </div>
            <div th:if="${errorMessage}" class="mb-6 p-4 bg-red-500/20 border border-red-500/50 rounded-lg">
                <p class="text-red-400"><i class="fas fa-exclamation-circle mr-2"></i><span
                        th:text="${errorMessage}"></span></p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Report Information -->
                <div class="lg:col-span-2 space-y-6">
                    <!-- Basic Info -->
                    <div class="bg-gradient-to-br from-[#2a2a2a] to-[#1e1e1e] border border-[#333] rounded-xl p-6">
                        <h2 class="text-xl font-bold text-white mb-6">
                            <i class="fas fa-info-circle text-gray-400 mr-2"></i>Report Information
                        </h2>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <p class="text-gray-400 text-sm mb-1">Report ID</p>
                                <p class="text-white font-semibold" th:text="${report.lvsReportId}">#1</p>
                            </div>

                            <div>
                                <p class="text-gray-400 text-sm mb-1">Type</p>
                                <span class="px-3 py-1 rounded-full text-xs font-bold inline-block" th:classappend="${report.lvsReportType.name() == 'USER'} ? 'bg-red-500/20 text-red-400' :
                                                   (${report.lvsReportType.name() == 'PROJECT'} ? 'bg-blue-500/20 text-blue-400' :
                                                   (${report.lvsReportType.name() == 'POST'} ? 'bg-green-500/20 text-green-400' :
                                                   (${report.lvsReportType.name() == 'COMMENT'} ? 'bg-yellow-500/20 text-yellow-400' :
                                                   'bg-purple-500/20 text-purple-400')))"
                                    th:text="${report.lvsReportType}">TYPE</span>
                            </div>

                            <div>
                                <p class="text-gray-400 text-sm mb-1">Status</p>
                                <span class="px-3 py-1 rounded-full text-xs font-bold inline-block" th:classappend="${report.lvsStatus.name() == 'PENDING'} ? 'bg-yellow-500/20 text-yellow-400' :
                                                   (${report.lvsStatus.name() == 'UNDER_REVIEW'} ? 'bg-purple-500/20 text-purple-400' :
                                                   (${report.lvsStatus.name() == 'RESOLVED'} ? 'bg-green-500/20 text-green-400' :
                                                   'bg-gray-500/20 text-gray-400'))"
                                    th:text="${report.lvsStatus}">STATUS</span>
                            </div>

                            <div>
                                <p class="text-gray-400 text-sm mb-1">Target ID</p>
                                <p class="text-white font-semibold" th:text="${report.lvsTargetId}">123</p>
                            </div>

                            <div>
                                <p class="text-gray-400 text-sm mb-1">Reporter</p>
                                <p class="text-white font-semibold" th:text="${report.lvsReporter.lvsUsername}">Username
                                </p>
                            </div>

                            <div>
                                <p class="text-gray-400 text-sm mb-1">Created At</p>
                                <p class="text-white font-semibold"
                                    th:text="${#temporals.format(report.lvsCreatedAt, 'dd/MM/yyyy HH:mm')}">Date</p>
                            </div>
                        </div>

                        <div class="mt-6 pt-6 border-t border-[#333]">
                            <p class="text-gray-400 text-sm mb-2">Reason</p>
                            <p class="text-white font-semibold text-lg mb-4" th:text="${report.lvsReason}">Reason</p>

                            <p class="text-gray-400 text-sm mb-2">Details</p>
                            <p class="text-gray-300" th:text="${report.lvsDetails}">Details</p>
                        </div>

                        <!-- View Reported Content -->
                        <div class="mt-6 pt-6 border-t border-[#333]">
                            <p class="text-gray-400 text-sm mb-3">Reported Content</p>

                            <!-- PROJECT Link -->
                            <a th:if="${report.lvsReportType.name() == 'PROJECT'}"
                                th:href="@{/LvsUser/LvsProject/LvsDetail/{id}(id=${report.lvsTargetId})}"
                                target="_blank"
                                class="inline-flex items-center gap-2 px-4 py-2 bg-blue-500/20 hover:bg-blue-500/30 text-blue-400 rounded-lg font-semibold transition-all">
                                <i class="fas fa-folder-open"></i>
                                <span>View Project</span>
                                <i class="fas fa-external-link-alt text-xs"></i>
                            </a>

                            <!-- POST Link -->
                            <a th:if="${report.lvsReportType.name() == 'POST'}"
                                th:href="@{/LvsUser/LvsBlog/LvsDetail/{id}(id=${report.lvsTargetId})}" target="_blank"
                                class="inline-flex items-center gap-2 px-4 py-2 bg-green-500/20 hover:bg-green-500/30 text-green-400 rounded-lg font-semibold transition-all">
                                <i class="fas fa-file-alt"></i>
                                <span>View Post</span>
                                <i class="fas fa-external-link-alt text-xs"></i>
                            </a>

                            <!-- COMMENT Link -->
                            <a th:if="${report.lvsReportType.name() == 'COMMENT'}"
                                th:href="@{/LvsUser/LvsBlog/LvsDetail/{id}(id=${report.lvsTargetId})}" target="_blank"
                                class="inline-flex items-center gap-2 px-4 py-2 bg-yellow-500/20 hover:bg-yellow-500/30 text-yellow-400 rounded-lg font-semibold transition-all">
                                <i class="fas fa-comment"></i>
                                <span>View Comment (in Post)</span>
                                <i class="fas fa-external-link-alt text-xs"></i>
                            </a>

                            <!-- REVIEW Link -->
                            <a th:if="${report.lvsReportType.name() == 'REVIEW'}"
                                th:href="@{/LvsUser/LvsProject/LvsDetail/{id}(id=${report.lvsTargetId})}"
                                target="_blank"
                                class="inline-flex items-center gap-2 px-4 py-2 bg-purple-500/20 hover:bg-purple-500/30 text-purple-400 rounded-lg font-semibold transition-all">
                                <i class="fas fa-star"></i>
                                <span>View Review (in Project)</span>
                                <i class="fas fa-external-link-alt text-xs"></i>
                            </a>

                            <!-- USER Link -->
                            <a th:if="${report.lvsReportType.name() == 'USER'}"
                                th:href="@{/LvsUser/LvsProfile/{id}(id=${report.lvsTargetId})}" target="_blank"
                                class="inline-flex items-center gap-2 px-4 py-2 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-lg font-semibold transition-all">
                                <i class="fas fa-user"></i>
                                <span>View User Profile</span>
                                <i class="fas fa-external-link-alt text-xs"></i>
                            </a>
                        </div>
                    </div>

                    <!-- Admin Notes (if exists) -->
                    <div th:if="${report.lvsAdminNote != null or report.lvsActionTaken != null}"
                        class="bg-gradient-to-br from-[#2a2a2a] to-[#1e1e1e] border border-[#333] rounded-xl p-6">
                        <h2 class="text-xl font-bold text-white mb-6">
                            <i class="fas fa-clipboard text-gray-400 mr-2"></i>Moderation Notes
                        </h2>

                        <div th:if="${report.lvsAdminHandler != null}" class="mb-4">
                            <p class="text-gray-400 text-sm mb-1">Handled By</p>
                            <p class="text-white font-semibold" th:text="${report.lvsAdminHandler.lvsUsername}">Admin
                            </p>
                        </div>

                        <div th:if="${report.lvsActionTaken != null}" class="mb-4">
                            <p class="text-gray-400 text-sm mb-1">Action Taken</p>
                            <p class="text-white" th:text="${report.lvsActionTaken}">Action</p>
                        </div>

                        <div th:if="${report.lvsAdminNote != null}">
                            <p class="text-gray-400 text-sm mb-1">Admin Note</p>
                            <p class="text-gray-300" th:text="${report.lvsAdminNote}">Note</p>
                        </div>

                        <div th:if="${report.lvsResolvedAt != null}" class="mt-4 pt-4 border-t border-[#333]">
                            <p class="text-gray-400 text-sm mb-1">Resolved At</p>
                            <p class="text-white font-semibold"
                                th:text="${#temporals.format(report.lvsResolvedAt, 'dd/MM/yyyy HH:mm')}">Date</p>
                        </div>
                    </div>
                </div>

                <!-- Resolve Form -->
                <div class="lg:col-span-1">
                    <div
                        class="bg-gradient-to-br from-purple-500/10 to-purple-600/5 border border-purple-500/20 rounded-xl p-6 sticky top-4">
                        <h2 class="text-xl font-bold text-white mb-6">
                            <i class="fas fa-gavel text-purple-400 mr-2"></i>Resolve Report
                        </h2>

                        <form th:action="@{/LvsModeration/LvsReport/LvsResolve/{id}(id=${report.lvsReportId})}"
                            method="post">
                            <!-- Admin Note -->
                            <div class="mb-4">
                                <label class="block text-gray-300 text-sm font-semibold mb-2">Admin Note</label>
                                <textarea name="adminNote" rows="4" required
                                    class="w-full bg-black/30 border border-[#333] rounded-lg px-4 py-2 text-white focus:border-purple-500 focus:outline-none"
                                    placeholder="Add your notes about this report..."></textarea>
                            </div>

                            <!-- Action Taken -->
                            <div class="mb-4">
                                <label class="block text-gray-300 text-sm font-semibold mb-2">Action Taken</label>
                                <input type="text" name="actionTaken" required
                                    class="w-full bg-black/30 border border-[#333] rounded-lg px-4 py-2 text-white focus:border-purple-500 focus:outline-none"
                                    placeholder="e.g., Content hidden, User warned">
                            </div>

                            <!-- New Status -->
                            <div class="mb-6">
                                <label class="block text-gray-300 text-sm font-semibold mb-2">New Status</label>
                                <select name="newStatus" required
                                    class="w-full bg-black/30 border border-[#333] rounded-lg px-4 py-2 text-white focus:border-purple-500 focus:outline-none">
                                    <option value="UNDER_REVIEW">Under Review</option>
                                    <option value="RESOLVED">Resolved</option>
                                    <option value="REJECTED">Rejected</option>
                                </select>
                            </div>

                            <!-- Submit Button -->
                            <button type="submit"
                                class="w-full px-6 py-3 bg-purple-500 hover:bg-purple-600 text-white rounded-lg font-bold transition-all">
                                <i class="fas fa-check mr-2"></i>Resolve Report
                            </button>
                        </form>


                        <!-- Quick Actions - Functional Hide/Show Buttons -->
                        <div class="mt-6 pt-6 border-t border-purple-500/20">
                            <p class="text-gray-400 text-sm mb-3">Quick Actions</p>

                            <!-- PROJECT Actions -->
                            <div th:if="${report.lvsReportType.name() == 'PROJECT'}" class="space-y-2">
                                <form th:action="@{/LvsModeration/LvsProject/LvsHide/{id}(id=${report.lvsTargetId})}"
                                    method="post">
                                    <input type="hidden" name="reportId" th:value="${report.lvsReportId}">
                                    <button type="submit"
                                        class="w-full px-4 py-2 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-lg font-semibold transition-all">
                                        <i class="fas fa-eye-slash mr-2"></i>Hide Project
                                    </button>
                                </form>
                                <form th:action="@{/LvsModeration/LvsProject/LvsShow/{id}(id=${report.lvsTargetId})}"
                                    method="post">
                                    <input type="hidden" name="reportId" th:value="${report.lvsReportId}">
                                    <button type="submit"
                                        class="w-full px-4 py-2 bg-green-500/20 hover:bg-green-500/30 text-green-400 rounded-lg font-semibold transition-all">
                                        <i class="fas fa-eye mr-2"></i>Show Project
                                    </button>
                                </form>
                            </div>

                            <!-- POST Actions -->
                            <div th:if="${report.lvsReportType.name() == 'POST'}" class="space-y-2">
                                <form th:action="@{/LvsModeration/LvsPost/LvsHide/{id}(id=${report.lvsTargetId})}"
                                    method="post">
                                    <input type="hidden" name="reportId" th:value="${report.lvsReportId}">
                                    <button type="submit"
                                        class="w-full px-4 py-2 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-lg font-semibold transition-all">
                                        <i class="fas fa-eye-slash mr-2"></i>Hide Post
                                    </button>
                                </form>
                                <form th:action="@{/LvsModeration/LvsPost/LvsShow/{id}(id=${report.lvsTargetId})}"
                                    method="post">
                                    <input type="hidden" name="reportId" th:value="${report.lvsReportId}">
                                    <button type="submit"
                                        class="w-full px-4 py-2 bg-green-500/20 hover:bg-green-500/30 text-green-400 rounded-lg font-semibold transition-all">
                                        <i class="fas fa-eye mr-2"></i>Show Post
                                    </button>
                                </form>
                            </div>

                            <!-- COMMENT Actions -->
                            <div th:if="${report.lvsReportType.name() == 'COMMENT'}" class="space-y-2">
                                <form th:action="@{/LvsModeration/LvsComment/LvsHide/{id}(id=${report.lvsTargetId})}"
                                    method="post">
                                    <input type="hidden" name="reportId" th:value="${report.lvsReportId}">
                                    <button type="submit"
                                        class="w-full px-4 py-2 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-lg font-semibold transition-all">
                                        <i class="fas fa-eye-slash mr-2"></i>Hide Comment
                                    </button>
                                </form>
                                <form th:action="@{/LvsModeration/LvsComment/LvsShow/{id}(id=${report.lvsTargetId})}"
                                    method="post">
                                    <input type="hidden" name="reportId" th:value="${report.lvsReportId}">
                                    <button type="submit"
                                        class="w-full px-4 py-2 bg-green-500/20 hover:bg-green-500/30 text-green-400 rounded-lg font-semibold transition-all">
                                        <i class="fas fa-eye mr-2"></i>Show Comment
                                    </button>
                                </form>
                            </div>

                            <!-- REVIEW Actions -->
                            <div th:if="${report.lvsReportType.name() == 'REVIEW'}" class="space-y-2">
                                <form th:action="@{/LvsModeration/LvsReview/LvsHide/{id}(id=${report.lvsTargetId})}"
                                    method="post">
                                    <input type="hidden" name="reportId" th:value="${report.lvsReportId}">
                                    <button type="submit"
                                        class="w-full px-4 py-2 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-lg font-semibold transition-all">
                                        <i class="fas fa-eye-slash mr-2"></i>Hide Review
                                    </button>
                                </form>
                                <form th:action="@{/LvsModeration/LvsReview/LvsShow/{id}(id=${report.lvsTargetId})}"
                                    method="post">
                                    <input type="hidden" name="reportId" th:value="${report.lvsReportId}">
                                    <button type="submit"
                                        class="w-full px-4 py-2 bg-green-500/20 hover:bg-green-500/30 text-green-400 rounded-lg font-semibold transition-all">
                                        <i class="fas fa-eye mr-2"></i>Show Review
                                    </button>
                                </form>
                            </div>

                            <!-- USER Actions (Ban/Unban) -->
                            <div th:if="${report.lvsReportType.name() == 'USER'}" class="space-y-2">
                                <form th:action="@{/LvsModeration/LvsUser/LvsBan/{id}(id=${report.lvsTargetId})}"
                                    method="post">
                                    <input type="hidden" name="reportId" th:value="${report.lvsReportId}">
                                    <button type="submit"
                                        class="w-full px-4 py-2 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-lg font-semibold transition-all">
                                        <i class="fas fa-ban mr-2"></i>Ban User
                                    </button>
                                </form>
                                <form th:action="@{/LvsModeration/LvsUser/LvsUnban/{id}(id=${report.lvsTargetId})}"
                                    method="post">
                                    <input type="hidden" name="reportId" th:value="${report.lvsReportId}">
                                    <button type="submit"
                                        class="w-full px-4 py-2 bg-green-500/20 hover:bg-green-500/30 text-green-400 rounded-lg font-semibold transition-all">
                                        <i class="fas fa-user-check mr-2"></i>Unban User
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>