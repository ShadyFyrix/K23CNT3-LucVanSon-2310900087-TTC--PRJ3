<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{LvsAreas/LvsAdmin/LvsLayout/LvsAdmin-layout}" lang="vi">

<head>
    <title>Chi tiết Danh mục</title>

    <style>
        :root {
            --primary-color: #4361ee;
            --success-color: #06d6a0;
            --warning-color: #ffd166;
            --danger-color: #ef476f;
            --dark-color: #1a1a2e;
            --light-color: #f8f9fa;
            --gray-color: #6c757d;
        }

        .detail-container {
            max-width: 1300px;
            margin: 2rem auto;
            padding: 1rem;
        }

        .category-header {
            background: linear-gradient(135deg, var(--primary-color), #3a56d4);
            border-radius: 20px;
            padding: 3rem;
            color: white;
            box-shadow: 0 12px 40px rgba(67, 97, 238, 0.25);
            margin-bottom: 2.5rem;
        }

        .category-icon {
            font-size: 5rem;
            margin-bottom: 1.5rem;
        }

        .category-title {
            font-size: 2.8rem;
            font-weight: 800;
        }

        .category-description {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 900px;
        }

        .category-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .meta-item {
            background: rgba(255, 255, 255, 0.15);
            padding: 1rem 1.5rem;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .meta-value {
            font-weight: 700;
            font-size: 1.2rem;
        }

        .stats-card {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            margin-bottom: 2rem;
            transition: transform 0.3s;
        }

        .stats-card:hover {
            transform: translateY(-4px);
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.5rem;
        }

        .info-item {
            padding: 1.2rem;
            background: #f8fafc;
            border-radius: 12px;
            transition: box-shadow 0.3s;
        }

        .info-item:hover {
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        }

        .badge {
            padding: 0.6rem 1.2rem;
            border-radius: 25px;
        }

        .projects-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .project-item {
            padding: 1.2rem;
            background: white;
            border-radius: 12px;
            border: 1px solid #f0f4f8;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .project-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.5rem;
        }

        .action-card {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }

        .action-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(67, 97, 238, 0.15);
        }

        .action-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .btn {
            border-radius: 10px;
            padding: 1rem 2rem;
            font-weight: 600;
            transition: transform 0.3s;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .category-header {
                padding: 2rem;
            }

            .quick-actions {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div layout:fragment="content">
        <div class="detail-container">
            <!-- Breadcrumb -->
            <nav aria-label="breadcrumb" class="mb-4">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/LvsAdmin/LvsDashboard">Dashboard</a></li>
                    <li class="breadcrumb-item"><a th:href="@{/LvsAdmin/LvsCategory/LvsList}">Danh mục</a></li>
                    <li class="breadcrumb-item active">Chi tiết</li>
                </ol>
            </nav>

            <!-- Alert Messages -->
            <div th:if="${LvsSuccess}" class="alert alert-success alert-dismissible fade show" role="alert">
                <div class="d-flex align-items-center">
                    <i class="fas fa-check-circle me-3 fs-4"></i>
                    <div th:text="${LvsSuccess}"></div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>

            <!-- Category Header -->
            <div class="category-header">
                <div class="row align-items-center">
                    <div class="col-lg-8">
                        <div class="category-icon">
                            <i th:class="${LvsCategory.lvsIcon} ?: 'fas fa-folder'"></i>
                        </div>
                        <h1 class="category-title" th:text="${LvsCategory.lvsCategoryName}"></h1>
                        <p class="category-description" th:text="${LvsCategory.lvsDescription} ?: 'Không có mô tả'"></p>

                        <div class="category-meta">
                            <div class="meta-item">
                                <i class="fas fa-hashtag"></i>
                                <div>
                                    <span class="meta-label">ID Danh mục</span>
                                    <span class="meta-value" th:text="${LvsCategory.lvsCategoryId}"></span>
                                </div>
                            </div>

                            <div class="meta-item">
                                <i class="fas fa-project-diagram"></i>
                                <div>
                                    <span class="meta-label">Số dự án</span>
                                    <span class="meta-value" th:text="${LvsProjectCount}"></span>
                                </div>
                            </div>

                            <div class="meta-item">
                                <i class="fas fa-sort-amount-down"></i>
                                <div>
                                    <span class="meta-label">Thứ tự hiển thị</span>
                                    <span class="meta-value" th:text="${LvsCategory.lvsSortOrder}"></span>
                                </div>
                            </div>

                            <div class="meta-item">
                                <i class="fas fa-calendar-alt"></i>
                                <div>
                                    <span class="meta-label">Ngày tạo</span>
                                    <span class="meta-value"
                                        th:text="${#temporals.format(LvsCategory.lvsCreatedAt, 'dd/MM/yyyy')}"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-4 text-center">
                        <div class="mt-4 mt-lg-0">
                            <div class="display-2 fw-bold mb-2" th:text="${LvsProjectCount}"></div>
                            <div class="h5 opacity-90">Tổng dự án</div>
                            <div class="mt-3">
                                <span class="badge"
                                    th:classappend="${LvsCategory.lvsIsActive} ? 'bg-success' : 'bg-danger'">
                                    <i
                                        th:class="${LvsCategory.lvsIsActive} ? 'fas fa-check-circle' : 'fas fa-times-circle'"></i>
                                    <span
                                        th:text="${LvsCategory.lvsIsActive} ? ' Đang hoạt động' : ' Vô hiệu hóa'"></span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content Row -->
            <div class="row">
                <!-- Left Column -->
                <div class="col-lg-8">
                    <!-- Basic Info Card -->
                    <div class="stats-card">
                        <h3 class="card-title">
                            <i class="fas fa-info-circle me-2 text-primary"></i>
                            Thông tin cơ bản
                        </h3>

                        <div class="info-grid">
                            <div class="info-item">
                                <div class="info-label">
                                    <i class="fas fa-tag"></i>
                                    Tên danh mục
                                </div>
                                <div class="info-value" th:text="${LvsCategory.lvsCategoryName}"></div>
                            </div>

                            <div class="info-item">
                                <div class="info-label">
                                    <i class="fas fa-icons"></i>
                                    Biểu tượng
                                </div>
                                <div class="info-value">
                                    <i th:if="${LvsCategory.lvsIcon}" th:class="${LvsCategory.lvsIcon}"></i>
                                    <span th:unless="${LvsCategory.lvsIcon}" class="text-muted">Chưa có</span>
                                </div>
                            </div>

                            <div class="info-item">
                                <div class="info-label">
                                    <i class="fas fa-palette"></i>
                                    Màu sắc
                                </div>
                                <div class="info-value">
                                    <span class="color-display"
                                        th:style="'background-color:' + ${LvsCategory.lvsColor} ?: '#e9ecef'"></span>
                                    <span th:text="${LvsCategory.lvsColor} ?: 'Mặc định'"></span>
                                </div>
                            </div>

                            <div class="info-item">
                                <div class="info-label">
                                    <i class="fas fa-toggle-on"></i>
                                    Trạng thái
                                </div>
                                <div class="info-value">
                                    <span th:if="${LvsCategory.lvsIsActive}" class="badge bg-success">Đang hoạt
                                        động</span>
                                    <span th:unless="${LvsCategory.lvsIsActive}" class="badge bg-danger">Vô hiệu
                                        hóa</span>
                                </div>
                            </div>

                            <div class="info-item">
                                <div class="info-label">
                                    <i class="fas fa-calendar-alt"></i>
                                    Ngày tạo
                                </div>
                                <div class="info-value"
                                    th:text="${#temporals.format(LvsCategory.lvsCreatedAt, 'HH:mm:ss dd/MM/yyyy')}">
                                </div>
                            </div>
                        </div>

                        <!-- Description -->
                        <div class="mt-4">
                            <h6 class="mb-3">
                                <i class="fas fa-align-left me-2 text-primary"></i>
                                Mô tả chi tiết
                            </h6>
                            <div class="p-3 bg-light rounded-3">
                                <div th:text="${LvsCategory.lvsDescription} ?: 'Không có mô tả'"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="stats-card">
                        <h3 class="card-title mb-4">
                            <i class="fas fa-bolt"></i>
                            Hành động nhanh
                        </h3>

                        <div class="quick-actions">
                            <a th:href="@{/LvsAdmin/LvsCategory/LvsEdit/{id}(id=${LvsCategory.lvsCategoryId})}"
                                class="action-card">
                                <div class="action-icon text-warning">
                                    <i class="fas fa-edit"></i>
                                </div>
                                <div class="action-title">Chỉnh sửa</div>
                                <div class="action-description">Cập nhật thông tin danh mục</div>
                            </a>

                            <form
                                th:action="@{/LvsAdmin/LvsCategory/LvsToggleActive/{id}(id=${LvsCategory.lvsCategoryId})}"
                                method="post" class="action-card">
                                <button type="submit" class="border-0 bg-transparent w-100 h-100">
                                    <div class="action-icon"
                                        th:classappend="${LvsCategory.lvsIsActive} ? 'text-danger' : 'text-success'">
                                        <i th:class="${LvsCategory.lvsIsActive} ? 'fas fa-ban' : 'fas fa-check'"></i>
                                    </div>
                                    <div class="action-title"
                                        th:text="${LvsCategory.lvsIsActive} ? 'Vô hiệu hóa' : 'Kích hoạt'"></div>
                                    <div class="action-description">Thay đổi trạng thái hoạt động</div>
                                </button>
                            </form>

                            <a th:href="@{/LvsAdmin/LvsProject/LvsAdd?categoryId={id}(id=${LvsCategory.lvsCategoryId})}"
                                class="action-card">
                                <div class="action-icon text-success">
                                    <i class="fas fa-plus-circle"></i>
                                </div>
                                <div class="action-title">Thêm dự án</div>
                                <div class="action-description">Tạo dự án mới trong danh mục</div>
                            </a>

                            <button type="button" class="action-card" onclick="printCategory()">
                                <div class="action-icon text-info">
                                    <i class="fas fa-print"></i>
                                </div>
                                <div class="action-title">In thông tin</div>
                                <div class="action-description">In chi tiết danh mục</div>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Right Column -->
                <div class="col-lg-4">
                    <!-- Stats Card -->
                    <div class="stats-card">
                        <h3 class="card-title mb-4">
                            <i class="fas fa-chart-bar"></i>
                            Thống kê
                        </h3>

                        <div class="text-center mb-4">
                            <div class="display-4 fw-bold text-primary" th:text="${LvsProjectCount}"></div>
                            <div class="text-muted">Tổng số dự án</div>
                        </div>

                        <div class="progress mb-3" style="height: 25px; border-radius: 12px;">
                            <div class="progress-bar bg-primary" role="progressbar"
                                th:style="'width:' + ${(LvsProjectCount > 10 ? 100 : LvsProjectCount * 10)} + '%;'"
                                th:attr="aria-valuenow=${LvsProjectCount}" aria-valuemin="0" aria-valuemax="10">
                                <span th:text="${LvsProjectCount}"></span> dự án
                            </div>
                        </div>
                    </div>

                    <!-- Related Projects -->
                    <div class="stats-card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <i class="fas fa-project-diagram"></i>
                                Dự án thuộc danh mục
                            </h3>
                            <span class="badge bg-success"
                                th:text="${LvsProjects != null ? LvsProjects.size() : 0}"></span>
                        </div>

                        <div th:if="${LvsProjects == null or #lists.isEmpty(LvsProjects)}" class="empty-state">
                            <div class="empty-icon">
                                <i class="fas fa-inbox"></i>
                            </div>
                            <h5 class="text-muted mb-3">Chưa có dự án</h5>
                            <p class="text-muted mb-3">Bắt đầu bằng cách thêm dự án đầu tiên vào danh mục này</p>
                            <a th:href="@{/LvsAdmin/LvsProject/LvsAdd?categoryId={id}(id=${LvsCategory.lvsCategoryId})}"
                                class="btn btn-success">
                                <i class="fas fa-plus me-2"></i>
                                Thêm dự án đầu tiên
                            </a>
                        </div>

                        <div th:unless="${LvsProjects == null or #lists.isEmpty(LvsProjects)}">
                            <div class="projects-list">
                                <a th:each="LvsProject : ${LvsProjects}"
                                    th:href="@{/LvsAdmin/LvsProject/LvsDetail/{id}(id=${LvsProject.lvsProjectId})}"
                                    class="project-item">
                                    <div class="project-info">
                                        <div class="project-name" th:text="${LvsProject.lvsProjectName}"></div>
                                        <div class="project-meta">
                                            <span
                                                th:text="${#temporals.format(LvsProject.lvsCreatedAt, 'dd/MM/yyyy')}"></span>
                                        </div>
                                    </div>
                                    <div>
                                        <span class="badge"
                                            th:classappend="${LvsProject.lvsStatus} == 'ACTIVE' ? 'bg-success' :
                                                            ${LvsProject.lvsStatus} == 'PENDING' ? 'bg-warning' : 'bg-secondary'"
                                            th:text="${LvsProject.lvsStatus}"></span>
                                    </div>
                                </a>
                            </div>

                            <div class="text-center mt-3">
                                <a th:href="@{/LvsAdmin/LvsProject/LvsList?categoryId={id}(id=${LvsCategory.lvsCategoryId})}"
                                    class="btn btn-outline-primary btn-sm">
                                    <i class="fas fa-external-link-alt me-2"></i>
                                    Xem tất cả dự án
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- System Information -->
                    <div class="stats-card">
                        <h3 class="card-title mb-4">
                            <i class="fas fa-cogs"></i>
                            Thông tin hệ thống
                        </h3>

                        <div class="list-group list-group-flush">
                            <div class="list-group-item d-flex justify-content-between align-items-center">
                                <div>
                                    <i class="fas fa-database text-primary me-2"></i>
                                    <span>ID Danh mục</span>
                                </div>
                                <span class="badge bg-dark" th:text="${LvsCategory.lvsCategoryId}"></span>
                            </div>

                            <div class="list-group-item d-flex justify-content-between align-items-center">
                                <div>
                                    <i class="fas fa-calendar-plus text-success me-2"></i>
                                    <span>Ngày tạo</span>
                                </div>
                                <small th:text="${#temporals.format(LvsCategory.lvsCreatedAt, 'dd/MM/yyyy')}"></small>
                            </div>

                            <div class="list-group-item d-flex justify-content-between align-items-center">
                                <div>
                                    <i class="fas fa-code-branch text-info me-2"></i>
                                    <span>Phiên bản hệ thống</span>
                                </div>
                                <span class="badge bg-dark">2.0.1</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Delete Confirmation Modal -->
            <div class="modal fade" id="deleteModal" tabindex="-1">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header border-0">
                            <h5 class="modal-title text-danger">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                Xác nhận xóa
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <p>Bạn có chắc chắn muốn xóa danh mục <strong
                                    th:text="${LvsCategory.lvsCategoryName}"></strong>?</p>
                            <div class="alert alert-warning" th:if="${LvsProjectCount} > 0">
                                <i class="fas fa-exclamation-circle me-2"></i>
                                Cảnh báo: Danh mục đang có <strong th:text="${LvsProjectCount}"></strong> dự án.
                                Tất cả dự án sẽ bị xóa hoặc không còn thuộc danh mục này!
                            </div>
                            <p class="text-muted mb-0">Hành động này không thể hoàn tác.</p>
                        </div>
                        <div class="modal-footer border-0">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy bỏ</button>
                            <form th:action="@{/LvsAdmin/LvsCategory/LvsDelete/{id}(id=${LvsCategory.lvsCategoryId})}"
                                method="post">
                                <button type="submit" class="btn btn-danger">Xác nhận xóa</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div layout:fragment="scripts">
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                // Initialize tooltips
                const tooltipTriggerList = [].slice.call(document.querySelectorAll('[title]'));
                tooltipTriggerList.map(function (tooltipTriggerEl) {
                    return new bootstrap.Tooltip(tooltipTriggerEl);
                });
            });

            function exportCategoryData() {
                const categoryId = '[[${LvsCategory.lvsCategoryId}]]';
                const categoryName = '[[${LvsCategory.lvsCategoryName}]]';

                alert(`Đang xuất dữ liệu cho danh mục "${categoryName}" (ID: ${categoryId})...\n\nChức năng này đang được phát triển.`);
            }

            function printCategory() {
                window.print();
            }

            function showDeleteModal() {
                const deleteModal = new bootstrap.Modal(document.getElementById('deleteModal'));
                deleteModal.show();
            }
        </script>
    </div>
</body>

</html>